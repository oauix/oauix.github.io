<!doctype html>
<html>
	<head>
		<title>springjdbc</title>
		<meta charset="utf-8" />
		<meta name="decription" content="说明书" />
		<meta name="keywords" content="关键词" />
		<!-- 显示区缩放 适用于手机 -->
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="../css/web.css" type="text/css" />
		<style>
			
		</style>
	</head>
	<body>
		<div class="body">
			<div class="content">
					<h3>myBatis</h3>
					<p>开源的持久层框架</p>
					<p>【现在常用数据库】</p>
					<p>jdbc 速度快,易掌握,要写sql,代码繁琐</p>
					<p>mybatis 速度适中,易掌握,要写sql,代码简洁</p>
					<p>hibernate[自动生成sql,复杂的程序,要常优化sql]</p>
					<p>ibatis apache->Mybatis[放弃] [被捡起]google->github</p><br/>
					
					<h3>Mybatis体系</h3>
					<p>1.加载配件文件</p>
					<p>2.解析SQL</p>
					<p>3.执行SQL</p>
					<p>4.映射结果</p>
					<h3>Mybatis配置文件</h3>
					<p>1.主配置文件SqlMapConfig.xml[常用Mybatis.xml] <a href="javascript:;" onclick="method1()">展开示例</a></p>
					<div id="test1" style="display:none" onclick="method1()">
<pre>
&lt;?xml version="1.0" encoding="UTF-8"?>
&lt;beans xmlns="http://www.springframework.org/schema/beans" 
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xmlns:context="http://www.springframework.org/schema/context" 
 xmlns:jdbc="http://www.springframework.org/schema/jdbc"  
 xmlns:jee="http://www.springframework.org/schema/jee" 
 xmlns:tx="http://www.springframework.org/schema/tx"
 xmlns:aop="http://www.springframework.org/schema/aop" 
 xmlns:mvc="http://www.springframework.org/schema/mvc"
 xmlns:util="http://www.springframework.org/schema/util"
 xmlns:jpa="http://www.springframework.org/schema/data/jpa"
 xsi:schemaLocation="
  http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
  http://www.springframework.org/schema/context http://www.springframework.org/schema/contex
  t/spring-context-3.2.xsd
  http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.2.xsd
  http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.2.xsd
  http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd
  http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-j
  pa-1.3.xsd
  http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd
  http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd
  http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd">
 &lt;!--读连接数据库配置文件,将其存储到id：db对象中-->
 &lt;util:properties id="db" location="classpath:mysql.txt" />
	
 &lt;!--配置连接池-->
 &lt;bean id="ds" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
  &lt;property name="driverclassName" value="#{db.driver}" />
  &lt;property name="url" value="#{db.url}" />
  &lt;property name="username" value="#{db.user}" />
   &lt;property name="password" value="#{db.password}" />
   &lt;property name="maxActive" value="#{db.maxactive}" />
   &lt;property name="maxWait" value="#{db.maxwait}" />
 &lt;/bean>
	
 &lt;!--配置SqlSessionFactoryBean对象-->
 &lt;bean id="ssfb" class="org.mybatis.spring.SqlSessionFactoryBean">
  &lt;!--指定连接池-->
  &lt;property name="dataSource" ref="ds" />
  &lt;!--指定映射文件的位置-->
  &lt;property name="mapperLocations" value="classpath:entity/*.xml" />
 &lt;/bean>
 &lt;!--配置MapperScannerConfigurer 类似Mapper映射器-->
 &lt;bean class="org.mybatis.spring.mapper.MapperScannerConfigurer">
  &lt;!--指定要扫描的包,将接口创建对象的对象-->
   &lt;property name="basePackage" value="dao" />
  &lt;/bean>
	
&lt;/beans>
</pre>					
					</div>
					<p>2.映射定义文件SqlMap.xml，用于定义SQL语句和映射信息</p>
					<p>【用法】</p>
					<p>1.导包 Mybatis，数据库驱动包,junit --mybatis包含连接池</p>
					<p>2.添加mybatis配置文件 --SqlMapConfig.xml[连接池配置文件] </p>
					<p>3.写实体类,它的属性跟数据库表的字段一致,不区分大小写</p>
					<p>4.编写EmpMapper.xml[sql语句文件],跟我们实体类放一起[同目录]</p>
					<p>最后业务层调用这里的方法,得到要的数据</p>
					<h3>解决表字段与实体类的属性不同</h3>
					<p>1.使用别名</p>
					<p>[别名用法]</p>
<pre>
	&lt;!-- 设置实体类的属性名与表字段名的对应关系
		 注:只需要将不一致的列出来-->
	&lt;resultMap type="entity.Emp" id="empResultMap">
		&lt;result property="empNo" column="id" />
		&lt;result property="ename" column="name" />
	&lt;/resultMap>
	
	&lt;select id="findById3" parameterType="int" resultMap="empResultMap" >
		select id,name,salary,age from t_emp where id=#{id}
	&lt;/select>
</pre>
					<p>2.写配置使属性对应别名</p>


					<h3>Mapper映射器</h3>
					<p>Mapper映射器:是一个符合映射文件要求的接口。自己理解:可以创建一个接口后就能用,容器自动创建实体类</p>
					<p>注:MyBatis会生成一个符合该接口的对象</p>
					<p>使用Mapper映射器：</p>
					<p>1.写一个接口</p>
						<p style="text-indent:4em">该接口要求:方法名与映射文件中的sqlid一样；参数与映射文件的parameterType一样[也可以用@Param自动注入];返回类型要跟resultType一样</p>
					<p>2.修改映射文件</p>
						<p style="text-indent:4em">将namespace设置为接口名[接口完整名]</p>
					<p>3.调用SqlSession对象的getMapper</p>

					<h3>spring集成Mybatis</h3>
						
						<p>[二种方式:]</p>
							<p>重点第一种:使用Mapper映射器集成</p>
							<p>1.导包 spring-webmvc Mybatis mybatis-spring[集成包] ojdbc dbcp junit spring-jdbc</p>
							<p>2.添加Spring集成配置文件：读取数据库配置文件,启动连接池对象</p>
							<p>3.配置SqlSessionFactoryBean对象</p>
							<p>4.写一个实体类,存储数据中转站的</p>
							<p>5.写一个接口,写一个接口对应的配置文件 映射文件</p>
							<p>6.写映射配置信息</p>
							<p>7.写测试类测试</p>
							<p>第二张【了解】步骤一样,但没有配置映射</p>

			</div>		
		</div>
		<script type="text/javascript">
			function method1(){
				//alert("method1方法调用成功！");
				var che=document.getElementById("test1").style;
				//console.log(document.getElementById("test1").style.display);
				if(che.display=="none"){
					che.display="block";
					//alert("block");
				}else{
					che.display="none";
					//alert("none");
				}
				
			}
		</script>
	</body>
</html>